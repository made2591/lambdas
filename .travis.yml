language: python
python:
  - "2.7"
branches:
  only: master
install:
  - pip install awscli
  - pip install aws-sam-cli
script:
  # - sam validate # due to https://github.com/awslabs/aws-sam-cli/issues/803
  - sam package --template-file template.yaml --s3-bucket $LAMBDAS_BUCKET --output-template-file packaged.yaml
deploy:
  provider: script
  script: sam deploy --template-file packaged.yaml --stack-name lambdas --capabilities CAPABILITY_IAM
  skip_cleanup: true
  on:
    branch: master
notifications:
  email:
    on_failure: always
env:
  global:
    - secure: "MrMLN9RmKHEmPb7+XEx/YL01O3vE8yKwL9da3/FSs2QP7r97+gNoMk/pXV5INi+4D3o+hOS7kGe/yktsqhjd2fAAS+rA2fXn3j6/YiyLMQ8zZY0kmMOxPKm3gFp2YtJ4kB6ImHQ1HK+fft4S4baEGFUuBeSbTjzJ9Z3XexEi6CyXm5FK/0Z9zYYu5fWCToY5u3ksW1l7rwwNfyaOzJh98l1886LNYFlknquCK3E0IL1bHV0O+88V51T+UMCKq3y6DdmSF+48MVSpDXyRhOSmlfcI5VPRp5FzetonklBCwYuWlk9S9UrXGurEIzPDlwYDDwxofOaHnVkVQIMRwCwvMVGCjCp6tvlewwytIQIu0qc4wBjakpZaLNJYV9O6Ktl1xxOkCPUa9hizP43hbQNo1zk2xOTjRxmjAj21OJpygPT65rRL/TaDMgc7WlaIJr4rvhdHPOIXLmcbi5zr5eofjTJSEgD1W6rzSG/3XA/XESVH4M9fkbQaorMcbBp1tVDE8xBdr9lKtnwXjBfOl1DvB696iIkgnY562tcjU6ZDUJKTHFXjGt7x4XNJ0wq42teNXD9Ep7sY1MKfHkqLvWelgEXOb6BX1BoywMlAnqIva2bLh+YJ9Jgfqt71HQGrjQ2Cle0LU2ueWgvtfNL5RkASbZRJIUV5pSkJFx5NXG3VVoo="
    - secure: "f/EgEGrrZfkwTtojeyYOEFlwa73qNRWAcusYmVciU9j3/PqRiVRQJXMRP3uGK2QIzFzYXVp+FxBXkAhZvHnDjp40pS58/hLMm3b4d85aNXE+gUvtP4slhgTtOtZSUnOkmFaxoUNlHhiNtsIg3XgN/xyubRSRa/gkBnnFH8K2WXH8qWVR1qT1hr4ebsBZzzAuWfoD8toMGqWXxj3z9R218tDjY1q+6uYzAO79rO4s5H5SJ3+S656p9SoTeLur70RTqO1qHLue/OvXaqubkiRHdbCq3r/VEA++tZux7/gX0lGTAv4X+TnBwwdPsEG8p13XO4fT2OK6jl8IDRZ8mLAxW4R0Sd4IocdEPCftoQUCs8Ae8ebYFelXnP5wqdljPksotplI5lI1eK/JWoABWi0L2hz+o7doRxPAtU/mNzCHjjgsVDHXEGwFc4egPD/rUz5iRjVob1Wc4zFV2x0dfpH0qwABwK2njzOBfHI0pQSR5T5ifKArJHvfVH49/YqZ+CDLjsrG8uRd17ITcqyIwzF6RlGxJ15zWUPrueYYkvu50dw/irKUIhwgLijPPrwjx5lx6VURWt8QelmN+C0RuYRv+QlAxuSolHbNpnpCpFJL8b7NgiLML4GOu2qhIDe0hcGHRXwFajiTAtD5gQc0c9RG3n5vQgTwtrXrBYm70OTjd34="
    - secure: "rCxssT45Af3Vtgq+tFkvC5qHflIgcasvS6tILF2+xcq8Q0MFuk7pOgnX2LPISgypsvI4Bmr1NG+eYEJVOW66sJ/lhet1z+9+n195tfyJsT0CgCUTMOqglEXPzT95iDhSpxZvwu0XEZSAEE5J0VWVXMkRCVzD092160dvHjVjg821/DC8Yo0HSR9Q1NMwHA2q6b8TR/m+EreTNlGm3GA+bQgctXZnbN4YmqEGpG+rr7Woio/7b9o/FOPNp3WF0qh5veCGKfrctsmdySTIJLSMRq1j1H6zIbh7nTjOjiWB+ys4vQhigu8kK5ggM1tJ7fKXRdhawSEXsqXFJ5+r/bs+2JYhwKTFJgIHxIyp/90KvGtlNypVICCtbvvolAihepDyTTD4FcQkvKX603fV2huC28HuxOl+0b81cbjJX5r1UhV9Uoeu5AC3PBTwP5u8VfWowqvxbPkoi/DcCyZXnS/RGOogqgbwS8q4V81QFTlk4TUNokFEB6RG1FcYYJp8LXkvf2KliD68I4ULY+AbWXEyjNGixCA0WhAEs/p4Ox8f9eyUAXPlMU75Ni+4xI5fvic9um50Iq5CBFVd+pb2Fe0YC2u6SaxvM3Vqf6MDIKKDG5HuvcRCaLXA0VPvV1pIdBEFQpUr9bUh+Ql5G4mgVP4BSLvgI+RohUKZ5U8LkBBAwOE="
    - secure: 7k4HZ18fOxGOiL+/gYttt7u/DQEpR9OsOwvTpYnQgXrOYM1zJQnGXr0wMiSD1IYE2E5MpJ/dQ2JChvShlw5f9eLnfikxKuLjq5XNExfyZpeOPfPlCuOBfTnwcTRu0kotkTXTnlewCqGRlJgbj/YUY5xOseN9mmoKdGxp8c6LFtj/QzEh/3in16FYtILr+DF3HVmPn40uANGhuvzlXVVjwMyiyz13gE6qpX+C3C6Yzx3Hoi9nC6ZzJXOmF9CFL7h5a7S3yxxAYNd11W5UofxVf8j/EhvKp91UiMx9KGS+Ph7ZVTw5tlo+J5Nkcmayegwe7tZ1NrQqC7GHCqtDkdiRCh8O3emSJ3mFbhzO0rAjWnfsgZuZVe9+hOaF2NBVm4rGHMjdfdn9EZtFNV7g+IpluBAWUT5DwWDPNkQIrGZCqYnBmSSVwbSzhFj6Ke4EhXHjnFF6GShXKraYszmXYExcRtphlT590a+eB0WMbOCwP0RdGeBVa+U+Wtsro7lg/QZzHPKC+0fy/F7Ppr1GTCCGfDBiPghA8QlxDu+8uj25ouLFBiO8kQSw2JAHxkiwuMtmVN0qBCEHJx7bqqP6butHHakCrDGk395BnWLm2EnoMEnRFIcksM+cxYOmJBBaslxhQV+/DKIJs3EvCEUzQ7Q7iWtukvpq1fp7/obRhQcWghU=
    - secure: rcXLuYb/m25jASnquKWg1WNT/+4FGJvPipYIryzGgzn8QLruFb9Q0HQoAFDRewDYMek4uPQlIHy+ij57D5b4h4001qD6Kdkq2qUg0bz/8DMCmpbn1PCS2n1w3qv1DaHoAbVSa7YKPNWjSRmlUXcDWgwyyRyWnDdEpvFfjwH78+OwDKKwORQrCUpqIWmmB+INp2KmEODpmQFjP5dh8aAciK8hOtgAqcoATjoVrrPEdCHPv0MfxU1RvyzRId8/QXAyQT4Tltt6aBlEkswYr3wPG+PyCkVEK0pqnBlLxuIskD/gvtejYYXuCW0qmCRmYRJYuSnUqN9GCqUiqt9a4jVaD3aTy9dthxuEjWHXRGk2nFjHE1iMKUceNHIwa9AumrrBz9UJXpcDxed/j71gCA/xONsij/hqnQCQiGICfnSsyrNWOGzi6IFkLATbZuFpRuYrQj7Lki3WMAX+SawPbf+SZ5VStz27tP13tOPcK36rXiYtoo0IJafixLM62sX93ki1eD4z2tT8arqvDosSL+LlnuaD+LSY/3GcKtMfhpJ6NiYrA/qo5ar5+cZmapPGua4dpmIVBpBRO9DyDorEXCbC37Op4y7ViUgkXGQw1iyMrcrT3CghmxXjzhUJxw1L3QDqg2FYLyAxQ0SsM3YzpZXGxA6/eQxyjO7NtT41stlOemM=
    - secure: X11j5cGrSejQ0pvU/c7FvIuI76sUUH1StafDQB6IF73B0oAil7VFGYUUzfS05PyHDIDQ148yMKu3PstREy+jBqDt2zumdHAAb36gztnkFE27tFXUl1xa7m7Rs8wD1Zu1QY7OcS5U62xB0nLDJYxugodn3xAHepeG3/CAqzSznPoc+96os5f0pTlMjcW0CKEvwtQBzmXDuQZn4Q7O7JLjRcmkpGmqZe+QPp9Hao6qnlBSsMELtEL9C99Keud0rMHIPftqXzXI4hUzg2F6Vsq3N/QAXihDKNUAVGnF7FZR9ss/N916oQxaHPtQgygRuv3nKn1GcOiyEf1NlJ1c3GdBluv7K+T1E0S+dMS9Ypp+7MWxRwd5Sd/uUQmkZqzmIPgpPw0Ne3olLgJ2nRNL21Xi+Ql0B4PMuThfIumQ/rCK+qQHeGIFd5DHhBBWp1JBuhqUvSSt7tAvdPlzmx7NGQZ1P7xJMHhwU8ZeZRoQG/jlgZoRPppy5yQZ+iNonrNRAvFLj5mn+Yyr+159u5lx10+NgQpxm+HcR/BAqMHU5ZSQDETMsEdPkaO04RSvh/9Guw7ms/NZ/y0LyB/ZNbgK2lcDMiqteUSjLuUiGjNYF7gj3OGxT/Ek9TzgAZ7WXvIoP/mjqE8cVc6fT+c2HqPZPOIQ3LgIutgNA4QuY4nc8MPDhe4=
    - secure: Nvxy/ZjsJcdhA9HG9bccP8ZHNmJiMfLLJexs1g3qnHo67kofkmPeiLWQw1dOErDL7s+kM8IYG0nNMjV3OPwdVcVNV96/Veo90nTNduelQKnJZm9Tf02hNXKd4MG7IK8Pzey2eICcCfEI/H2iMgQE7Aq/jJAEHQWr99iM11JF9b9WmQQkoKLqRealtf8k7Q/u7zsoT5fd9McMYz+92/70msJuqHvGHLsryaYXnrVxVi+PEXLg6MV+M85Fi1ZCqF8sFS9zoQoJMWNOUrIPOne1chUdn7LgPodrlWlxoXhDXUeBEn06XD/mHHD6/mMRnQuy3he1DuRpY/3Dt9FUjtlN/cGoqxfBXMoImJRrlHbXuqQeW2nDGY1P2zrcJaIMUyRJ3EVKC/hcK3WmQLPOhFiW5kufb9zaLbz4sN5hCZ2nczzrRYoYgUszfjUg2sBqRDaHSnQ1OJu5GiGWz7jaUa+E4WYIOC059lAM4fWc+pzqZlySeEASKj3LuO6oUBGSUJWw35ONtrEAwVoVlQxhZyBp2zJd5c2Wx96XaM0tJpgIl/yO+t3bNMyqcxsGQBsnEsckTH0KbAQgv2wMnM64guBcwHcoQS8uXtygFbOv+IJV66dz0HE5yyq0Sn13qw5A30x+pJcTZWKwerG5Uco8XciKsmnyxo+VrKbrBz+NhhMSRxk=
